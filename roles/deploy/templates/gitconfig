# Global git config file

# Good reference for "classic" options :
# https://jvns.ca/blog/2024/02/16/popular-git-config-options/

[user]
  name = {{ git_user_name }}
  email = {{ git_user_email }}

[push]
  # Only push the current branch
  default = upstream

  # Don't need to specify --set-upstream when pushing a new branch
  autoSetupRemote = true

[pull]
  # Abort pulling if local and remote have diverged
  ff = only

[core]
  # Repair files with Windows-endline-formatting-style (CRLF) on commit :
  autocrlf = input

[alias]
  # This pretty format is equivalent to --oneline --decorate, with the addition of commiter name and date
  # See https://stackoverflow.com/questions/5889878/color-in-git-log#16844346
  # and https://git-scm.com/docs/pretty-formats
  fullog = log --graph --all --date-order --pretty=tformat:'%C(auto)%h%d %s %Cgreen(%cr) %Cblue<%an>'

[merge]
  tool = vimdiff

  # https://ductile.systems/zdiff3/
  conflictstyle = zdiff3

[rerere]
  enabled = true

[diff]
  # cf https://difftastic.wilfred.me.uk/git.html
  # TODO : automatically install difftastic
  external = difft

  # https://luppeng.wordpress.com/2020/10/10/when-to-use-each-of-the-git-diff-algorithms/
  algorithm = histogram

[mergetool]
  # Git, please, just stop dropping files in my working directory whenever I run `git mergetool`
  keepbackup = false
  # Thank you

# Use https://github.com/dandavison/delta as pager
# I'm not sure whether this is redundant with difftastic or not
[core]
  pager = delta
[interactive]
  diffFilter = delta --color-only
[delta]
  navigate = true    # use n and N to move between diff sections
[diff]
  colorMoved = default

[commit]
  verbose = true

[rebase]
  # https://andrewlock.net/working-with-stacked-branches-in-git-is-easier-with-update-refs/
  # For now, I'll experiment with explicit --update-refs on the cli, to decide whether I want it to be enabled by default or not
  # updateRefs = true

# Detect corruption eagerly, this should not be needed but if it ever is, detecting the corruption eagerly may be essential
[transfer]
  fsckobjects = true
[fetch]
  fsckobjects = true
[receive]
  fsckObjects = true

# More sensible submodule-related behavior
[status]
  submoduleSummary = true
[diff]
  submodule = log
[submodule]
  recurse = true

# Sort branches and tags by latest activity instead of alphabetically
[branch]
  sort = -committerdate
[tag]
  sort = taggerdate

# automatically clean up obsolete remote-tracking branches and tags
[fetch]
  prune = true
  prunetags = true

# Format dates in git log as iso
[log]
  date = iso

# Include private configuration
[include]
  path = gitconfig.private

